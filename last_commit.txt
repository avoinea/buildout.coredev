Repository: plone.schemaeditor


Branch: refs/heads/master
Date: 2020-03-16T23:09:04+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.schemaeditor/commit/5748ca6184aff15b0fc481bce4714cfba03affb5

Fix broken import from p.a.z3cform and remove BBB

Files changed:
A news/74.breaking
A news/74.bugfix
M README.rst
M plone/schemaeditor/schema.py
M setup.py

b'diff --git a/README.rst b/README.rst\nindex d634c2e..3d163eb 100644\n--- a/README.rst\n+++ b/README.rst\n@@ -6,11 +6,11 @@ schemata (interfaces).\n \n Currently there is support for:\n \n- * adding and removing fields\n- * editing attributes of existing fields\n- * reordering fields\n- * renaming fields\n- * organizing fields into fieldsets\n+* adding and removing fields\n+* editing attributes of existing fields\n+* reordering fields\n+* renaming fields\n+* organizing fields into fieldsets\n \n plone.schemaeditor only handles the actual schema editing.  To be useful, it\n requires some integration code to take care of the following pieces:\n@@ -23,15 +23,15 @@ one approach to this integration.\n \n The following field types (from zope.schema) are currently supported:\n \n- * TextLine\n- * Text\n- * Int\n- * Float\n- * Bool\n- * Password\n- * Datetime\n- * Choice (with simple list of values)\n- * List of Choice (with simple list of values)\n+* TextLine\n+* Text\n+* Int\n+* Float\n+* Bool\n+* Password\n+* Datetime\n+* Choice (with simple list of values)\n+* List of Choice (with simple list of values)\n \n Third-party packages can make additional field types available by registering\n new IFieldFactory utilities.\n@@ -57,10 +57,10 @@ Author:\n \n Contributors:\n \n- * Nathan Van Gheem\n- * Martin Aspeli\n- * Alex Limi\n- * Ross Patterson\n- * Steve McMahon\n- * Thomas Desvenain\n-\n+* Nathan Van Gheem\n+* Martin Aspeli\n+* Alex Limi\n+* Ross Patterson\n+* Steve McMahon\n+* Thomas Desvenain\n+* et al\ndiff --git a/news/74.breaking b/news/74.breaking\nnew file mode 100644\nindex 0000000..4d565ac\n--- /dev/null\n+++ b/news/74.breaking\n@@ -0,0 +1 @@\n+Remove backward compatibility with old collective.z3cform.datetimewidget from Plone 4.3 times. [jensens]\ndiff --git a/news/74.bugfix b/news/74.bugfix\nnew file mode 100644\nindex 0000000..02831e1\n--- /dev/null\n+++ b/news/74.bugfix\n@@ -0,0 +1,2 @@\n+Fix broken import from ``plone.app.z3cform``. \n+This make it work with ``zope.interface`` > 5 [jensens]\ndiff --git a/plone/schemaeditor/schema.py b/plone/schemaeditor/schema.py\nindex 10c000c..d289f94 100644\n--- a/plone/schemaeditor/schema.py\n+++ b/plone/schemaeditor/schema.py\n@@ -1,31 +1,16 @@\n # -*- coding: utf-8 -*-\n+from plone.app.z3cform.interfaces import IDateField\n+from plone.app.z3cform.interfaces import IDatetimeField\n from plone.schemaeditor import _\n-from zope import interface\n from zope import schema\n+from zope.interface import alsoProvides\n from zope.schema import interfaces\n \n \n-try:\n-    from plone.app.z3cform.widget import IDatetimeField as IDatetime\n-    from plone.app.z3cform.widget import IDateField as IDate\n-    IDatetime, IDate  # pyflakes\n-except ImportError:\n-    try:\n-        from collective.z3cform.datetimewidget.interfaces import (\n-            IDatetimeField as IDatetime)\n-        from collective.z3cform.datetimewidget.interfaces import (\n-            IDateField as IDate)\n-        IDatetime, IDate  # pyflakes\n-    except ImportError:\n-        IDatetime = interfaces.IDatetime\n-        IDate = interfaces.IDate\n-\n-\n # get rid of unhelpful help text\n interfaces.IMinMaxLen[\'min_length\'].description = u\'\'\n interfaces.IMinMaxLen[\'max_length\'].description = u\'\'\n \n-\n # now fix up some of the schemas with missing details\n \n class IBool(interfaces.IBool, interfaces.IFromUnicode):\n@@ -47,7 +32,7 @@ class IFloat(interfaces.IFloat, interfaces.IFromUnicode):\n     )\n \n \n-class IDatetime(IDatetime):\n+class IDatetime(IDatetimeField):\n \n     min = schema.Datetime(\n         title=interfaces.IDatetime[\'min\'].title,\n@@ -62,7 +47,7 @@ class IDatetime(IDatetime):\n     )\n \n \n-class IDate(IDate):\n+class IDate(IDateField):\n \n     min = schema.Date(\n         title=interfaces.IDate[\'min\'].title,\n@@ -77,8 +62,7 @@ class IDate(IDate):\n     )\n \n \n-class IChoice(interfaces.IChoice,\n-              interfaces.IFromUnicode):\n+class IChoice(interfaces.IChoice, interfaces.IFromUnicode):\n     pass\n \n \n@@ -95,7 +79,7 @@ class ITextLineChoice(interfaces.IField):\n         required=interfaces.IChoice[\'vocabulary\'].required,\n         default=interfaces.IChoice[\'vocabulary\'].default,\n         value_type=schema.TextLine())\n-    interface.alsoProvides(values, ITextLinesField)\n+    alsoProvides(values, ITextLinesField)\n \n     vocabularyName = schema.Choice(\n         title=interfaces.IChoice[\'vocabularyName\'].title,\ndiff --git a/setup.py b/setup.py\nindex 2a6748a..20c5afb 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -3,7 +3,7 @@\n from setuptools import setup\n \n \n-version = \'2.1.1.dev0\'\n+version = \'3.0.0.dev0\'\n \n setup(\n     name=\'plone.schemaeditor\',\n@@ -13,15 +13,17 @@\n     open("CHANGES.rst").read(),\n     classifiers=[\n         "Development Status :: 6 - Mature",\n-        "Framework :: Zope2",\n+        "Framework :: Zope",\n         "Framework :: Zope :: 4",\n         "Framework :: Plone",\n-        "Framework :: Plone :: 5.1",\n+        "Framework :: Plone :: Core",\n         "Framework :: Plone :: 5.2",\n+        "Framework :: Plone :: 6.0",\n         "Programming Language :: Python",\n         "Programming Language :: Python :: 2.7",\n         "Programming Language :: Python :: 3.6",\n         "Programming Language :: Python :: 3.7",\n+        "Programming Language :: Python :: 3.8",\n         "Topic :: Software Development :: Libraries :: Python Modules",\n         "License :: OSI Approved :: BSD License",\n     ],\n@@ -37,7 +39,7 @@\n     install_requires=[\n         \'setuptools\',\n         \'six\',\n-        \'Zope2\',\n+        \'Zope\',\n         \'zope.cachedescriptors\',\n         \'zope.component\',\n         \'zope.container\',\n@@ -48,6 +50,7 @@\n         \'zope.publisher\',\n         \'z3c.form\',\n         \'plone.z3cform\',\n+        \'plone.app.z3cform\',\n         \'plone.autoform\',\n     ],\n     extras_require={\'test\': [\n'

Repository: plone.schemaeditor


Branch: refs/heads/master
Date: 2020-03-17T10:46:21+01:00
Author: agitator (agitator) <agitator@users.noreply.github.com>
Commit: https://github.com/plone/plone.schemaeditor/commit/4c162f8244b62ff016941bacc679e124c355cf65

Merge pull request #74 from plone/rm-broken-imports-with-bbb

Fix broken import from p.a.z3cform and remove BBB

Files changed:
A news/74.breaking
A news/74.bugfix
M README.rst
M plone/schemaeditor/schema.py
M setup.py

b'diff --git a/README.rst b/README.rst\nindex d634c2e..3d163eb 100644\n--- a/README.rst\n+++ b/README.rst\n@@ -6,11 +6,11 @@ schemata (interfaces).\n \n Currently there is support for:\n \n- * adding and removing fields\n- * editing attributes of existing fields\n- * reordering fields\n- * renaming fields\n- * organizing fields into fieldsets\n+* adding and removing fields\n+* editing attributes of existing fields\n+* reordering fields\n+* renaming fields\n+* organizing fields into fieldsets\n \n plone.schemaeditor only handles the actual schema editing.  To be useful, it\n requires some integration code to take care of the following pieces:\n@@ -23,15 +23,15 @@ one approach to this integration.\n \n The following field types (from zope.schema) are currently supported:\n \n- * TextLine\n- * Text\n- * Int\n- * Float\n- * Bool\n- * Password\n- * Datetime\n- * Choice (with simple list of values)\n- * List of Choice (with simple list of values)\n+* TextLine\n+* Text\n+* Int\n+* Float\n+* Bool\n+* Password\n+* Datetime\n+* Choice (with simple list of values)\n+* List of Choice (with simple list of values)\n \n Third-party packages can make additional field types available by registering\n new IFieldFactory utilities.\n@@ -57,10 +57,10 @@ Author:\n \n Contributors:\n \n- * Nathan Van Gheem\n- * Martin Aspeli\n- * Alex Limi\n- * Ross Patterson\n- * Steve McMahon\n- * Thomas Desvenain\n-\n+* Nathan Van Gheem\n+* Martin Aspeli\n+* Alex Limi\n+* Ross Patterson\n+* Steve McMahon\n+* Thomas Desvenain\n+* et al\ndiff --git a/news/74.breaking b/news/74.breaking\nnew file mode 100644\nindex 0000000..4d565ac\n--- /dev/null\n+++ b/news/74.breaking\n@@ -0,0 +1 @@\n+Remove backward compatibility with old collective.z3cform.datetimewidget from Plone 4.3 times. [jensens]\ndiff --git a/news/74.bugfix b/news/74.bugfix\nnew file mode 100644\nindex 0000000..02831e1\n--- /dev/null\n+++ b/news/74.bugfix\n@@ -0,0 +1,2 @@\n+Fix broken import from ``plone.app.z3cform``. \n+This make it work with ``zope.interface`` > 5 [jensens]\ndiff --git a/plone/schemaeditor/schema.py b/plone/schemaeditor/schema.py\nindex 10c000c..d289f94 100644\n--- a/plone/schemaeditor/schema.py\n+++ b/plone/schemaeditor/schema.py\n@@ -1,31 +1,16 @@\n # -*- coding: utf-8 -*-\n+from plone.app.z3cform.interfaces import IDateField\n+from plone.app.z3cform.interfaces import IDatetimeField\n from plone.schemaeditor import _\n-from zope import interface\n from zope import schema\n+from zope.interface import alsoProvides\n from zope.schema import interfaces\n \n \n-try:\n-    from plone.app.z3cform.widget import IDatetimeField as IDatetime\n-    from plone.app.z3cform.widget import IDateField as IDate\n-    IDatetime, IDate  # pyflakes\n-except ImportError:\n-    try:\n-        from collective.z3cform.datetimewidget.interfaces import (\n-            IDatetimeField as IDatetime)\n-        from collective.z3cform.datetimewidget.interfaces import (\n-            IDateField as IDate)\n-        IDatetime, IDate  # pyflakes\n-    except ImportError:\n-        IDatetime = interfaces.IDatetime\n-        IDate = interfaces.IDate\n-\n-\n # get rid of unhelpful help text\n interfaces.IMinMaxLen[\'min_length\'].description = u\'\'\n interfaces.IMinMaxLen[\'max_length\'].description = u\'\'\n \n-\n # now fix up some of the schemas with missing details\n \n class IBool(interfaces.IBool, interfaces.IFromUnicode):\n@@ -47,7 +32,7 @@ class IFloat(interfaces.IFloat, interfaces.IFromUnicode):\n     )\n \n \n-class IDatetime(IDatetime):\n+class IDatetime(IDatetimeField):\n \n     min = schema.Datetime(\n         title=interfaces.IDatetime[\'min\'].title,\n@@ -62,7 +47,7 @@ class IDatetime(IDatetime):\n     )\n \n \n-class IDate(IDate):\n+class IDate(IDateField):\n \n     min = schema.Date(\n         title=interfaces.IDate[\'min\'].title,\n@@ -77,8 +62,7 @@ class IDate(IDate):\n     )\n \n \n-class IChoice(interfaces.IChoice,\n-              interfaces.IFromUnicode):\n+class IChoice(interfaces.IChoice, interfaces.IFromUnicode):\n     pass\n \n \n@@ -95,7 +79,7 @@ class ITextLineChoice(interfaces.IField):\n         required=interfaces.IChoice[\'vocabulary\'].required,\n         default=interfaces.IChoice[\'vocabulary\'].default,\n         value_type=schema.TextLine())\n-    interface.alsoProvides(values, ITextLinesField)\n+    alsoProvides(values, ITextLinesField)\n \n     vocabularyName = schema.Choice(\n         title=interfaces.IChoice[\'vocabularyName\'].title,\ndiff --git a/setup.py b/setup.py\nindex 2a6748a..20c5afb 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -3,7 +3,7 @@\n from setuptools import setup\n \n \n-version = \'2.1.1.dev0\'\n+version = \'3.0.0.dev0\'\n \n setup(\n     name=\'plone.schemaeditor\',\n@@ -13,15 +13,17 @@\n     open("CHANGES.rst").read(),\n     classifiers=[\n         "Development Status :: 6 - Mature",\n-        "Framework :: Zope2",\n+        "Framework :: Zope",\n         "Framework :: Zope :: 4",\n         "Framework :: Plone",\n-        "Framework :: Plone :: 5.1",\n+        "Framework :: Plone :: Core",\n         "Framework :: Plone :: 5.2",\n+        "Framework :: Plone :: 6.0",\n         "Programming Language :: Python",\n         "Programming Language :: Python :: 2.7",\n         "Programming Language :: Python :: 3.6",\n         "Programming Language :: Python :: 3.7",\n+        "Programming Language :: Python :: 3.8",\n         "Topic :: Software Development :: Libraries :: Python Modules",\n         "License :: OSI Approved :: BSD License",\n     ],\n@@ -37,7 +39,7 @@\n     install_requires=[\n         \'setuptools\',\n         \'six\',\n-        \'Zope2\',\n+        \'Zope\',\n         \'zope.cachedescriptors\',\n         \'zope.component\',\n         \'zope.container\',\n@@ -48,6 +50,7 @@\n         \'zope.publisher\',\n         \'z3c.form\',\n         \'plone.z3cform\',\n+        \'plone.app.z3cform\',\n         \'plone.autoform\',\n     ],\n     extras_require={\'test\': [\n'

