Repository: Products.Archetypes


Branch: refs/heads/master
Date: 2020-03-23T11:53:20+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.Archetypes/commit/d5521cd2ed729255b6167ecef4132f621b0339f7

Use manage_FTPget instead of manage_DAVget in marshall tests.

Adds compatibility with Zope 4.3.

Files changed:
A news/644.bugfix
M Products/Archetypes/tests/folder_marshall.txt

b'diff --git a/Products/Archetypes/tests/folder_marshall.txt b/Products/Archetypes/tests/folder_marshall.txt\nindex a5512205..eaac779d 100644\n--- a/Products/Archetypes/tests/folder_marshall.txt\n+++ b/Products/Archetypes/tests/folder_marshall.txt\n@@ -15,16 +15,10 @@ under the same banner, and play nicely with WebDAV.\n   >>> from plone.app.testing import setRoles\n   >>> from plone.app.testing import TEST_USER_ID\n   >>> setRoles(portal, TEST_USER_ID, [\'Manager\'])\n-\n-CMF 1.5 returns the id of the created object, CMF 1.4 doesn\'t ...\n-\n-  >>> portal.invokeFactory(\'SimpleFolder\', \'simple_folder\') in \\\n-  ...                           (None, \'simple_folder\')\n-  True\n-\n-  >>> portal.invokeFactory(\'SimpleBTreeFolder\', \'simple_btree_folder\') \\\n-  ...                           in (None, \'simple_btree_folder\')\n-  True\n+  >>> portal.invokeFactory(\'SimpleFolder\', \'simple_folder\')\n+  \'simple_folder\'\n+  >>> portal.invokeFactory(\'SimpleBTreeFolder\', \'simple_btree_folder\')\n+  \'simple_btree_folder\'\n \n Make sure we\'ve got some reasonable marshaller setup over there:\n \n@@ -40,8 +34,8 @@ enable the new behaviour on folderish objects that have\n \n   >>> folder = portal.simple_folder\n \n-  >>> from Testing.ZopeTestCase.zopedoctest.functional import http \n-  >>> from Testing.ZopeTestCase.sandbox import AppZapper \n+  >>> from Testing.ZopeTestCase.zopedoctest.functional import http\n+  >>> from Testing.ZopeTestCase.sandbox import AppZapper\n   >>> AppZapper().set(layer[\'app\'])\n   >>> print http(r"""\n   ... PUT /%s/simple_folder HTTP/1...\n@@ -63,11 +57,11 @@ enable the new behaviour on folderish objects that have\n   <BLANKLINE>\n \n Note that \'GET\' will also result in the same response. We simulate a\n-WebDAV \'GET\' by appending \'manage_DAVget\' to the target, which is just\n+WebDAV \'GET\' by appending \'manage_FTPget\' to the target, which is just\n about what the \'WebDAVSrcHandler\' does:\n \n   >>> print http(r"""\n-  ... GET /%s/simple_folder/manage_DAVget HTTP/1...\n+  ... GET /%s/simple_folder/manage_FTPget HTTP/1...\n   ... Authorization: Basic %s:%s\n   ... """ % (portal_name, user_name, user_password))\n   HTTP/1... 405 Method Not Allowed\n@@ -97,7 +91,7 @@ like a normal resource:\n   True\n \n   >>> print http(r"""\n-  ... GET /%s/simple_folder/manage_DAVget HTTP/1...\n+  ... GET /%s/simple_folder/manage_FTPget HTTP/1...\n   ... Authorization: Basic %s:%s\n   ... """ % (portal_name, user_name, user_password))\n   HTTP/1... 200 OK\n@@ -141,11 +135,11 @@ The same for BTreeFolder:\n   AttributeError: ...called_afterPUT_hook...\n \n Note that \'GET\' will also result in the same response. We simulate a\n-WebDAV \'GET\' by appending \'manage_DAVget\' to the target, which is just\n+WebDAV \'GET\' by appending \'manage_FTPget\' to the target, which is just\n about what the \'WebDAVSrcHandler\' does:\n \n   >>> print http(r"""\n-  ... GET /%s/simple_btree_folder/manage_DAVget HTTP/1...\n+  ... GET /%s/simple_btree_folder/manage_FTPget HTTP/1...\n   ... Authorization: Basic %s:%s\n   ... """ % (portal_name, user_name, user_password))\n   HTTP/1... 405 Method Not Allowed\n@@ -175,7 +169,7 @@ like a normal resource:\n   True\n \n   >>> print http(r"""\n-  ... GET /%s/simple_btree_folder/manage_DAVget HTTP/1...\n+  ... GET /%s/simple_btree_folder/manage_FTPget HTTP/1...\n   ... Authorization: Basic %s:%s\n   ... """ % (portal_name, user_name, user_password))\n   HTTP/1... 200 OK\ndiff --git a/news/644.bugfix b/news/644.bugfix\nnew file mode 100644\nindex 00000000..73c47af9\n--- /dev/null\n+++ b/news/644.bugfix\n@@ -0,0 +1,3 @@\n+Use manage_FTPget instead of manage_DAVget in marshall tests.\n+Adds compatibility with Zope 4.3.\n+[maurits]\n'

Repository: Products.Archetypes


Branch: refs/heads/master
Date: 2020-03-25T23:32:36+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.Archetypes/commit/0176f6894bb232960d6e00f546a351defecb9239

Merge branch 'zope-4.2.1'

Files changed:
A news/644.bugfix
M Products/Archetypes/tests/folder_marshall.txt

b'diff --git a/Products/Archetypes/tests/folder_marshall.txt b/Products/Archetypes/tests/folder_marshall.txt\nindex a5512205..eaac779d 100644\n--- a/Products/Archetypes/tests/folder_marshall.txt\n+++ b/Products/Archetypes/tests/folder_marshall.txt\n@@ -15,16 +15,10 @@ under the same banner, and play nicely with WebDAV.\n   >>> from plone.app.testing import setRoles\n   >>> from plone.app.testing import TEST_USER_ID\n   >>> setRoles(portal, TEST_USER_ID, [\'Manager\'])\n-\n-CMF 1.5 returns the id of the created object, CMF 1.4 doesn\'t ...\n-\n-  >>> portal.invokeFactory(\'SimpleFolder\', \'simple_folder\') in \\\n-  ...                           (None, \'simple_folder\')\n-  True\n-\n-  >>> portal.invokeFactory(\'SimpleBTreeFolder\', \'simple_btree_folder\') \\\n-  ...                           in (None, \'simple_btree_folder\')\n-  True\n+  >>> portal.invokeFactory(\'SimpleFolder\', \'simple_folder\')\n+  \'simple_folder\'\n+  >>> portal.invokeFactory(\'SimpleBTreeFolder\', \'simple_btree_folder\')\n+  \'simple_btree_folder\'\n \n Make sure we\'ve got some reasonable marshaller setup over there:\n \n@@ -40,8 +34,8 @@ enable the new behaviour on folderish objects that have\n \n   >>> folder = portal.simple_folder\n \n-  >>> from Testing.ZopeTestCase.zopedoctest.functional import http \n-  >>> from Testing.ZopeTestCase.sandbox import AppZapper \n+  >>> from Testing.ZopeTestCase.zopedoctest.functional import http\n+  >>> from Testing.ZopeTestCase.sandbox import AppZapper\n   >>> AppZapper().set(layer[\'app\'])\n   >>> print http(r"""\n   ... PUT /%s/simple_folder HTTP/1...\n@@ -63,11 +57,11 @@ enable the new behaviour on folderish objects that have\n   <BLANKLINE>\n \n Note that \'GET\' will also result in the same response. We simulate a\n-WebDAV \'GET\' by appending \'manage_DAVget\' to the target, which is just\n+WebDAV \'GET\' by appending \'manage_FTPget\' to the target, which is just\n about what the \'WebDAVSrcHandler\' does:\n \n   >>> print http(r"""\n-  ... GET /%s/simple_folder/manage_DAVget HTTP/1...\n+  ... GET /%s/simple_folder/manage_FTPget HTTP/1...\n   ... Authorization: Basic %s:%s\n   ... """ % (portal_name, user_name, user_password))\n   HTTP/1... 405 Method Not Allowed\n@@ -97,7 +91,7 @@ like a normal resource:\n   True\n \n   >>> print http(r"""\n-  ... GET /%s/simple_folder/manage_DAVget HTTP/1...\n+  ... GET /%s/simple_folder/manage_FTPget HTTP/1...\n   ... Authorization: Basic %s:%s\n   ... """ % (portal_name, user_name, user_password))\n   HTTP/1... 200 OK\n@@ -141,11 +135,11 @@ The same for BTreeFolder:\n   AttributeError: ...called_afterPUT_hook...\n \n Note that \'GET\' will also result in the same response. We simulate a\n-WebDAV \'GET\' by appending \'manage_DAVget\' to the target, which is just\n+WebDAV \'GET\' by appending \'manage_FTPget\' to the target, which is just\n about what the \'WebDAVSrcHandler\' does:\n \n   >>> print http(r"""\n-  ... GET /%s/simple_btree_folder/manage_DAVget HTTP/1...\n+  ... GET /%s/simple_btree_folder/manage_FTPget HTTP/1...\n   ... Authorization: Basic %s:%s\n   ... """ % (portal_name, user_name, user_password))\n   HTTP/1... 405 Method Not Allowed\n@@ -175,7 +169,7 @@ like a normal resource:\n   True\n \n   >>> print http(r"""\n-  ... GET /%s/simple_btree_folder/manage_DAVget HTTP/1...\n+  ... GET /%s/simple_btree_folder/manage_FTPget HTTP/1...\n   ... Authorization: Basic %s:%s\n   ... """ % (portal_name, user_name, user_password))\n   HTTP/1... 200 OK\ndiff --git a/news/644.bugfix b/news/644.bugfix\nnew file mode 100644\nindex 00000000..73c47af9\n--- /dev/null\n+++ b/news/644.bugfix\n@@ -0,0 +1,3 @@\n+Use manage_FTPget instead of manage_DAVget in marshall tests.\n+Adds compatibility with Zope 4.3.\n+[maurits]\n'

