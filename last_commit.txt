Repository: mockup


Branch: refs/heads/master
Date: 2020-02-26T17:28:23+01:00
Author: Fred van Dijk (fredvd) <fredvd@gmail.com>
Commit: https://github.com/plone/mockup/commit/112c07e62f9a9f5555ebabbfa8f54214458447bf

Generate a random id and append it, because there might be more than one TinyMCE in the DOM

Files changed:
A news/945.bugfix
M mockup/patterns/tinymce/pattern.js

b'diff --git a/mockup/patterns/tinymce/pattern.js b/mockup/patterns/tinymce/pattern.js\nindex b8aa43c77..a49dfff02 100644\n--- a/mockup/patterns/tinymce/pattern.js\n+++ b/mockup/patterns/tinymce/pattern.js\n@@ -422,12 +422,16 @@ define([\n          * .plone-modal-dialog and use that as the ui_container\n          * setting for TinyMCE to anchor it there. This ensures that\n          * sub-menus are displayed relative to the modal rather than\n-         * the document body. */\n+         * the document body. \n+         * Generate a random id and append it, because there might be\n+         * more than one TinyMCE in the DOM.\n+         */\n         var modal_container = self.$el.parents(".plone-modal-dialog")\n \n         if (modal_container.length > 0) {\n-            modal_container.attr("id", "tiny-ui-container");\n-            tinyOptions["ui_container"] = "#tiny-ui-container";\n+            var random_id = Math.random().toString(36).substring(2, 15) ;\n+            modal_container.attr("id", "tiny-ui-container-" + random_id);\n+            tinyOptions[\'ui_container\'] = "#tiny-ui-container-" + random_id;\n         }\n         tinymce.init(tinyOptions);\n         self.tiny = tinymce.get(self.tinyId);\ndiff --git a/news/945.bugfix b/news/945.bugfix\nnew file mode 100644\nindex 000000000..50c3a95f6\n--- /dev/null\n+++ b/news/945.bugfix\n@@ -0,0 +1,2 @@\n+TinyMCE pattern: add a random id to the passed in container_id: there might be more than one TinyMCE active in the DOM. Improves #920 which was a fix for positioning of sub-menus in a modal.\n+[fredvd]\n\\ No newline at end of file\n'

Repository: mockup


Branch: refs/heads/master
Date: 2020-03-01T22:15:50+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/mockup/commit/70bbcd016f2a0c2fd8ab1fffde5b3ecbb6d5a60c

Merge pull request #945 from plone/fredvd_multiple_tinymce_modal

Generate a random id and append it to the container_id

Files changed:
A news/945.bugfix
M mockup/patterns/tinymce/pattern.js

b'diff --git a/mockup/patterns/tinymce/pattern.js b/mockup/patterns/tinymce/pattern.js\nindex b8aa43c77..a49dfff02 100644\n--- a/mockup/patterns/tinymce/pattern.js\n+++ b/mockup/patterns/tinymce/pattern.js\n@@ -422,12 +422,16 @@ define([\n          * .plone-modal-dialog and use that as the ui_container\n          * setting for TinyMCE to anchor it there. This ensures that\n          * sub-menus are displayed relative to the modal rather than\n-         * the document body. */\n+         * the document body. \n+         * Generate a random id and append it, because there might be\n+         * more than one TinyMCE in the DOM.\n+         */\n         var modal_container = self.$el.parents(".plone-modal-dialog")\n \n         if (modal_container.length > 0) {\n-            modal_container.attr("id", "tiny-ui-container");\n-            tinyOptions["ui_container"] = "#tiny-ui-container";\n+            var random_id = Math.random().toString(36).substring(2, 15) ;\n+            modal_container.attr("id", "tiny-ui-container-" + random_id);\n+            tinyOptions[\'ui_container\'] = "#tiny-ui-container-" + random_id;\n         }\n         tinymce.init(tinyOptions);\n         self.tiny = tinymce.get(self.tinyId);\ndiff --git a/news/945.bugfix b/news/945.bugfix\nnew file mode 100644\nindex 000000000..50c3a95f6\n--- /dev/null\n+++ b/news/945.bugfix\n@@ -0,0 +1,2 @@\n+TinyMCE pattern: add a random id to the passed in container_id: there might be more than one TinyMCE active in the DOM. Improves #920 which was a fix for positioning of sub-menus in a modal.\n+[fredvd]\n\\ No newline at end of file\n'

