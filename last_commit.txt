Repository: plone.restapi


Branch: refs/heads/master
Date: 2020-03-15T18:41:30+01:00
Author: Timo Stollenwerk (tisto) <tisto@users.noreply.github.com>
Commit: https://github.com/plone/plone.restapi/commit/ea3bf8713a7a31be2520f776c1747256614c95ff

Upgrade to Plone 5.2.1 (#883)

* Upgrade to Plone 5.2.1

* Do not pin release related pkgs.

* Remove sphinx version pins.

* zest.releaser=6.20.1

* Pin sphinx for Plone 4.3.

* Run sphinxbuilder for py 3.7 only. sphinx does not work on py 3.8 yet

* Update docs to Plone 5.2.1.

* Pin Pygments = 2.5.1 for Plone 4.3

* No sphinx on py 3.8

* Pin releaser/sphinx on 5.1

* Remove commented out pins.

* Move plone.schema pin to 4.3/5.1

* Remove remaining versions.cfg pins.

Files changed:
M .travis.yml
M plone-4.3.x.cfg
M plone-5.1.x.cfg
M plone-5.2.x.cfg
M src/plone/restapi/tests/http-examples/history_get.resp
M src/plone/restapi/tests/http-examples/registry_get_list.resp
M src/plone/restapi/tests/http-examples/translated_messages_object_history.resp
M src/plone/restapi/tests/http-examples/vocabularies.resp
M test-no-uncommitted-doc-changes.in
M versions.cfg

b'diff --git a/.travis.yml b/.travis.yml\nindex a0b24e58..eb5fb8bd 100644\n--- a/.travis.yml\n+++ b/.travis.yml\n@@ -53,10 +53,10 @@ install:\n script:\n   - bin/code-analysis\n   - if [ -f "bin/black" ]; then bin/black src/ --check ; fi\n-  - bin/sphinxbuilder\n+  - if [ "$PLONE_VERSION" == "5.2.x" ] && [ $TRAVIS_PYTHON_VERSION == \'3.7\' ]; then bin/sphinxbuilder ; fi\n   - bin/test\n   - bin/test-no-uncommitted-doc-changes\n-  - bin/test-no-sphinx-warnings\n+  - if [ "$PLONE_VERSION" == "5.2.x" ] && [ $TRAVIS_PYTHON_VERSION == \'3.7\' ]; then bin/test-no-sphinx-warnings ; fi\n after_success:\n   - bin/test-coverage\n   - pip install coverage==3.7.1 coveralls\ndiff --git a/plone-4.3.x.cfg b/plone-4.3.x.cfg\nindex 9af1ade3..f0a28357 100644\n--- a/plone-4.3.x.cfg\n+++ b/plone-4.3.x.cfg\n@@ -15,3 +15,25 @@ six = 1.11.0\n # Required for Python 2.7 compatibility\n more-itertools = <6.0.0\n zipp = >=0.5, <2a\n+\n+# plone.restapi specific\n+plone.schema = 1.2.0\n+\n+# zest.releaser\n+zest.releaser = 6.20.1\n+twine = 1.11.0\n+requests = 2.18.4\n+towncrier = 19.2.0\n+zestreleaser.towncrier = 1.1.0\n+# docutils = 0.13.1\n+\n+# Sphinx\n+Sphinx = 1.6.5\n+docutils = 0.14\n+Pygments = 2.5.1\n+sphinxcontrib-httpexample = 0.7.0\n+sphinxcontrib-httpdomain = 1.5.0\n+sphinx-rtd-theme = 0.2.4\n+Jinja2 = 2.10\n+Babel = 2.5.1\n+astunparse = 1.6.2\n\\ No newline at end of file\ndiff --git a/plone-5.1.x.cfg b/plone-5.1.x.cfg\nindex 7c225d18..2fa89a63 100644\n--- a/plone-5.1.x.cfg\n+++ b/plone-5.1.x.cfg\n@@ -6,4 +6,26 @@ extends =\n \n [versions]\n # fixes: SyntaxError: invalid syntax (more.py, line 340)\n-zipp = 0.5.2\n\\ No newline at end of file\n+zipp = 0.5.2\n+\n+# plone.restapi specific\n+plone.schema = 1.2.0\n+\n+# zest.releaser\n+zest.releaser = 6.20.1\n+twine = 1.11.0\n+requests = 2.18.4\n+towncrier = 19.2.0\n+zestreleaser.towncrier = 1.1.0\n+# docutils = 0.13.1\n+\n+# Sphinx\n+Sphinx = 1.6.5\n+docutils = 0.14\n+Pygments = 2.5.1\n+sphinxcontrib-httpexample = 0.7.0\n+sphinxcontrib-httpdomain = 1.5.0\n+sphinx-rtd-theme = 0.2.4\n+Jinja2 = 2.10\n+Babel = 2.5.1\n+astunparse = 1.6.2\n\\ No newline at end of file\ndiff --git a/plone-5.2.x.cfg b/plone-5.2.x.cfg\nindex dcb0452a..f551d422 100644\n--- a/plone-5.2.x.cfg\n+++ b/plone-5.2.x.cfg\n@@ -1,7 +1,7 @@\n [buildout]\n extends =\n     base.cfg\n-    http://dist.plone.org/release/5.2/versions.cfg\n+    http://dist.plone.org/release/5.2.1/versions.cfg\n     versions.cfg\n find-links += http://dist.plone.org/thirdparty/\n versions=versions\ndiff --git a/src/plone/restapi/tests/http-examples/history_get.resp b/src/plone/restapi/tests/http-examples/history_get.resp\nindex 2fc40e7a..7aec16f9 100644\n--- a/src/plone/restapi/tests/http-examples/history_get.resp\n+++ b/src/plone/restapi/tests/http-examples/history_get.resp\n@@ -22,9 +22,9 @@ Content-Type: application/json\n     "action": "Create", \n     "actor": {\n       "@id": "http://localhost:55001/plone/@users/test_user_1_", \n-      "fullname": "", \n+      "fullname": "test_user_1_", \n       "id": "test_user_1_", \n-      "username": "test-user"\n+      "username": null\n     }, \n     "comments": "", \n     "review_state": "private", \ndiff --git a/src/plone/restapi/tests/http-examples/registry_get_list.resp b/src/plone/restapi/tests/http-examples/registry_get_list.resp\nindex 9a4dffae..33df71b6 100644\n--- a/src/plone/restapi/tests/http-examples/registry_get_list.resp\n+++ b/src/plone/restapi/tests/http-examples/registry_get_list.resp\n@@ -6,7 +6,7 @@ Content-Type: application/json\n   "batching": {\n     "@id": "http://localhost:55001/plone/@registry", \n     "first": "http://localhost:55001/plone/@registry?b_start=0", \n-    "last": "http://localhost:55001/plone/@registry?b_start=1675", \n+    "last": "http://localhost:55001/plone/@registry?b_start=1750", \n     "next": "http://localhost:55001/plone/@registry?b_start=25"\n   }, \n   "items": [\n@@ -403,5 +403,5 @@ Content-Type: application/json\n       "value": false\n     }\n   ], \n-  "items_total": 1686\n+  "items_total": 1775\n }\n\\ No newline at end of file\ndiff --git a/src/plone/restapi/tests/http-examples/translated_messages_object_history.resp b/src/plone/restapi/tests/http-examples/translated_messages_object_history.resp\nindex 01a9f0c5..ba5e62be 100644\n--- a/src/plone/restapi/tests/http-examples/translated_messages_object_history.resp\n+++ b/src/plone/restapi/tests/http-examples/translated_messages_object_history.resp\n@@ -22,9 +22,9 @@ Content-Type: application/json\n     "action": "Crear", \n     "actor": {\n       "@id": "http://localhost:55001/plone/@users/test_user_1_", \n-      "fullname": "", \n+      "fullname": "test_user_1_", \n       "id": "test_user_1_", \n-      "username": "test-user"\n+      "username": null\n     }, \n     "comments": "", \n     "review_state": "private", \ndiff --git a/src/plone/restapi/tests/http-examples/vocabularies.resp b/src/plone/restapi/tests/http-examples/vocabularies.resp\nindex 697b9f97..bee7edf1 100644\n--- a/src/plone/restapi/tests/http-examples/vocabularies.resp\n+++ b/src/plone/restapi/tests/http-examples/vocabularies.resp\n@@ -10,6 +10,10 @@ Content-Type: application/json\n     "@id": "http://localhost:55001/plone/@vocabularies/plone.contentrules.events", \n     "title": "plone.contentrules.events"\n   }, \n+  {\n+    "@id": "http://localhost:55001/plone/@vocabularies/Behaviors", \n+    "title": "Behaviors"\n+  }, \n   {\n     "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.AvailableContentLanguages", \n     "title": "plone.app.vocabularies.AvailableContentLanguages"\n@@ -146,10 +150,6 @@ Content-Type: application/json\n     "@id": "http://localhost:55001/plone/@vocabularies/plone.schemaeditor.VocabulariesVocabulary", \n     "title": "plone.schemaeditor.VocabulariesVocabulary"\n   }, \n-  {\n-    "@id": "http://localhost:55001/plone/@vocabularies/Behaviors", \n-    "title": "Behaviors"\n-  }, \n   {\n     "@id": "http://localhost:55001/plone/@vocabularies/plone.formwidget.relations.cmfcontentsearch", \n     "title": "plone.formwidget.relations.cmfcontentsearch"\ndiff --git a/test-no-uncommitted-doc-changes.in b/test-no-uncommitted-doc-changes.in\nindex d49188bb..e21fe30b 100644\n--- a/test-no-uncommitted-doc-changes.in\n+++ b/test-no-uncommitted-doc-changes.in\n@@ -13,10 +13,12 @@ function red {\n     echo "$RED $1 $RESET"\n }\n \n-if [ "$PLONE_VERSION" = "4.3.x" ] || [ "$PLONE_VERSION" = "5.0.x" ] || [ "$PLONE_VERSION" = "5.1.x" ] || [ $TRAVIS_PYTHON_VERSION == \'2.7\' ]; then\n+if [ "$PLONE_VERSION" == "5.2.x" ] && [ $TRAVIS_PYTHON_VERSION == \'3.7\' ]; then\n+    echo "Running check for undocumented changes for Plone 5.2.x on Python 3.7"\n+else\n     # request/response dumps have known differences for Plone 5\n     # => skip, we can\'t have the Plone 5 build fail because of those\n-    echo "Skipping checks for undocumented changes for Plone 4, 5.0.x, and 5.1.x."\n+    echo "Skipping checks for undocumented changes for everything except Plone 5.2.x on Python 3.7"\n     exit 0\n fi\n \ndiff --git a/versions.cfg b/versions.cfg\nindex 8086ef94..361e6b8d 100644\n--- a/versions.cfg\n+++ b/versions.cfg\n@@ -2,38 +2,15 @@\n # Buildout\n setuptools =\n zc.buildout =\n-zc.recipe.egg = 2.0.3\n+# zc.recipe.egg = 2.0.3\n \n # plone.recipe.varnish\n-plone.recipe.varnish = 1.3\n+# plone.recipe.varnish = 1.3\n \n # Code-analysis\n # plone.recipe.codeanalysis = 3.0.1\n # coverage = 3.7.1\n # pep8 = 1.7.1\n-flake8 = 3.7.9\n+# flake8 = 3.7.9\n # flake8-coding = 1.3.2\n-pycodestyle = 2.5.0\n-\n-# Release\n-zest.releaser = 6.17.0\n-twine = 1.11.0\n-requests = 2.18.4\n-towncrier = 19.2.0\n-zestreleaser.towncrier = 1.1.0\n-docutils = 0.13.1\n-\n-# Sphinx\n-Sphinx = 1.6.5\n-docutils = 0.14\n-Pygments = 2.2.0\n-sphinxcontrib-httpexample = 0.7.0\n-sphinxcontrib-httpdomain = 1.5.0\n-sphinx-rtd-theme = 0.2.4\n-Jinja2 = 2.10\n-Babel = 2.5.1\n-astunparse = 1.6.2\n-\n-# plone.restapi specific\n-plone.schema = 1.2.0\n-\n+# pycodestyle = 2.5.0\n'

